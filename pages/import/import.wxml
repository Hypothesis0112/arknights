<view class="page">
  <view class="header">
    <text class="title">批量粘贴导入抽卡记录（JSON 数组）</text>
  </view>

  <view class="content">
    <textarea class="paste-area" value="{{pasteText}}" bindinput="onPasteInput" maxlength="-1" placeholder='示例: [{"pool":"standard","operator":"阿米娅","rarity":6,"isTarget":true,"timestamp":1702905600000}]' auto-height></textarea>

    <view class="buttons">
      <button bindtap="onAnalyzePaste" type="default">仅分析（预览）</button>
      <button bindtap="onImportAndSave" type="primary">导入并保存（去重）</button>
      <button bindtap="onCancel" type="warn">取消</button>
    </view>

    <view wx:if="{{pastePreviewCount !== 0 || pasteErrors.length !== 0}}" class="preview">
      <text>有效记录: {{pastePreviewCount}}，错误行: {{pasteErrors.length}}</text>
      <block wx:if="{{pasteErrors.length > 0}}">
        <view class="error-sample">
          <text>示例错误: {{pasteErrors[0].error}}</text>
        </view>
      </block>
    </view>
  </view>
</view>